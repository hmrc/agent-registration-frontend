@*
 * Copyright 2025 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.agentregistrationfrontend.action.AgentApplicationRequest
@import uk.gov.hmrc.agentregistrationfrontend.controllers.applicantcontactdetails.routes as applicantRoutes
@import uk.gov.hmrc.agentregistrationfrontend.controllers.amls.routes as amlsDetailsRoutes
@import uk.gov.hmrc.agentregistrationfrontend.views.html.Layout

@this(
        layout: Layout,
        govukTaskList: GovukTaskList
)

@()(implicit
        request: AgentApplicationRequest[?],
        messages: Messages
)

@key = @{"taskList"}
@title = @{messages(s"$key.title", request.agentApplication.asLlpApplication.getBusinessDetails.companyProfile.companyName)}
@amlsStatus = @{
    if(request.agentApplication.amlsDetails.exists(_.isComplete)) {
        TaskListItemStatus(content = Text(messages(s"$key.status.Completed")))
    } else {
        TaskListItemStatus(
            tag = Some(Tag(
                content = Text(messages(s"$key.status.Incomplete")),
                classes = "govuk-tag--blue"
            ))
        )
    }
}
@layout(
    pageTitle = title,
    suppressBackLink = true
) {

    <h1 class="govuk-heading-l">@title</h1>

    <h2 class="govuk-heading-m">@messages(s"$key.businessDetails.heading")</h2>
    @govukTaskList(TaskList(
        items = Seq(
            TaskListItem(
                title = TaskListItemTitle(
                    content = Text(messages(s"$key.businessDetails.linkText"))
                ),
                status = TaskListItemStatus(
                    content = Text(messages(s"$key.status.Completed"))
                ),
                href = Some("#") // TODO we don't have a CYA view yet...
            )
        ),
        idPrefix = "businessDetails"
    ))

    <h2 class="govuk-heading-m">@messages(s"$key.contact.heading")</h2>
    @govukTaskList(TaskList(
        items = Seq(
            TaskListItem(
                title = TaskListItemTitle(
                    content = Text(messages(s"$key.contact.linkText"))
                ),
                status = TaskListItemStatus(
                    tag = Some(Tag(
                        content = Text(messages(s"$key.status.Incomplete")),
                        classes = "govuk-tag--blue"
                    ))
                ),
                href = Some(applicantRoutes.ApplicantRoleInLlpController.show.url) // TODO Switch to CYA link when available
            )
        ),
        idPrefix = "contact"
    ))

    <h2 class="govuk-heading-m">@messages(s"$key.accountDetails.heading")</h2>
    @govukTaskList(TaskList(
        items = Seq(
            TaskListItem(
                title = TaskListItemTitle(
                    content = Text(messages(s"$key.accountDetails.linkText"))
                ),
                status = TaskListItemStatus(
                    content = Text(messages(s"$key.status.CannotStartYet"))
                ),
                href = None
            )
        ),
        idPrefix = "accountDetails"
    ))

    <h2 class="govuk-heading-m">@messages(s"$key.hmrcStandards.heading")</h2>
    @govukTaskList(TaskList(
        items = Seq(
            TaskListItem(
                title = TaskListItemTitle(
                    content = Text(messages(s"$key.hmrcStandards.amls.linkText"))
                ),
                status = amlsStatus,
                href = Some(amlsDetailsRoutes.CheckYourAnswersController.show.url)
            ),
            TaskListItem(
                title = TaskListItemTitle(
                    content = Text(messages(s"$key.hmrcStandards.agreement.linkText"))
                ),
                status = TaskListItemStatus(
                    tag = Some(Tag(
                        content = Text(messages(s"$key.status.Incomplete")),
                        classes = "govuk-tag--blue"
                    ))
                ),
                href = Some("#") // TODO Add link when available
            )
        ),
        idPrefix = "hmrcStandards"
    ))

    <h2 class="govuk-heading-m">@messages(s"$key.declaration.heading")</h2>
    @govukTaskList(TaskList(
        items = Seq(
            TaskListItem(
                title = TaskListItemTitle(
                    content = Text(messages(s"$key.declaration.linkText"))
                ),
                status = TaskListItemStatus(
                    content = Text(messages(s"$key.status.CannotStartYet"))
                ),
                href = None
            )
        ),
        idPrefix = "declaration"
    ))
}
