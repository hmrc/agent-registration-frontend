@*
 * Copyright 2025 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.agentregistration.shared.BusinessType
@import uk.gov.hmrc.agentregistrationfrontend.config.AppConfig
@import uk.gov.hmrc.agentregistrationfrontend.views.html.Layout
@import uk.gov.hmrc.agentregistrationfrontend.views.html.apply.aboutyourbusiness.LimitedCompany.{AnswerSummary as AnswerSummaryLimitedCompany}
@import uk.gov.hmrc.agentregistrationfrontend.views.html.apply.aboutyourbusiness.Llp.{AnswerSummary as AnswerSummaryLlp}
@import uk.gov.hmrc.agentregistrationfrontend.views.html.apply.aboutyourbusiness.SoleTrader.{AnswerSummary as AnswerSummarySoleTrader}
@import uk.gov.hmrc.agentregistrationfrontend.views.html.apply.aboutyourbusiness.GeneralPartnership.{AnswerSummary as AnswerSummaryGeneralPartnership}
@import uk.gov.hmrc.agentregistrationfrontend.views.html.apply.aboutyourbusiness.LimitedPartnership.{AnswerSummary as AnswerSummaryLimitedPartnership}
@import uk.gov.hmrc.agentregistrationfrontend.views.html.apply.aboutyourbusiness.ScottishLimitedPartnership.{AnswerSummary as AnswerSummaryScottishLimitedPartnership}
@import uk.gov.hmrc.agentregistrationfrontend.views.html.apply.aboutyourbusiness.ScottishPartnership.{AnswerSummary as AnswerSummaryScottishPartnership}
@import uk.gov.hmrc.agentregistrationfrontend.views.html.apply.applicantcontactdetails.{AnswerSummary as ContactAnswers}
@import uk.gov.hmrc.agentregistrationfrontend.views.html.apply.agentdetails.{AnswerSummary as AgentDetailsAnswers}
@import uk.gov.hmrc.agentregistrationfrontend.views.html.apply.amls.{AnswerSummary as AmlsAnswers}
@import uk.gov.hmrc.agentregistration.shared.*
@import views.html.helper.CSPNonce

@this(
        appConfig: AppConfig,
        layout: Layout,
        govukButton: GovukButton,
        govukSummaryList: GovukSummaryList,
        answerSummaryLlp: AnswerSummaryLlp,
        answerSummaryLimitedCompany: AnswerSummaryLimitedCompany,
        answerSummarySoleTrader: AnswerSummarySoleTrader,
        answerSummaryGeneralPartnership: AnswerSummaryGeneralPartnership,
        answerSummaryLimitedPartnership: AnswerSummaryLimitedPartnership,
        answerSummaryScottishLimitedPartnership: AnswerSummaryScottishLimitedPartnership,
        answerSummaryScottishPartnership: AnswerSummaryScottishPartnership,
        contactAnswers: ContactAnswers,
        agentDetailsAnswers: AgentDetailsAnswers,
        amlsAnswers: AmlsAnswers
)

@(
        entityName: String,
        agentApplication: AgentApplication)(implicit
        request: RequestHeader,
        messages: Messages
)

@key = @{
    "viewApplication"
}
@title = @{
    messages(s"$key.title", entityName)
}
@provideDetailsLink = @{appConfig.applicationLink(agentApplication.linkId.value).toString}
@aboutYourBusinessAnswers =  @{
  agentApplication match {
    case agentApplication: AgentApplicationSoleTrader =>
      answerSummarySoleTrader(
        key = "aboutYourBusinessCheckYourAnswers",
        answers = agentApplication.getBusinessDetails,
        userRole = agentApplication.getUserRole,
        canChange = false
      )
    case agentApplication: AgentApplicationLlp =>
      answerSummaryLlp(
        key = "aboutYourBusinessCheckYourAnswers",
        answers = agentApplication.getBusinessDetails,
        userRole = agentApplication.getUserRole,
        canChange = false
      )
    case agentApplication: AgentApplicationLimitedCompany =>
      answerSummaryLimitedCompany(
        key = "aboutYourBusinessCheckYourAnswers",
        answers = agentApplication.asLimitedCompanyApplication.getBusinessDetails,
        userRole = agentApplication.getUserRole,
        canChange = false
      )
    case agentApplication: AgentApplicationGeneralPartnership =>
      answerSummaryGeneralPartnership(
        key = "aboutYourBusinessCheckYourAnswers",
        answers = agentApplication.getBusinessDetails,
        userRole = agentApplication.getUserRole,
        canChange = false,
        entityName = entityName
      )
    case agentApplication: AgentApplicationLimitedPartnership =>
      answerSummaryLimitedPartnership(
        key = "aboutYourBusinessCheckYourAnswers",
        answers = agentApplication.getBusinessDetails,
        userRole = agentApplication.getUserRole,
        canChange = false,
        entityName = entityName
      )
    case agentApplication: AgentApplicationScottishLimitedPartnership =>
      answerSummaryScottishLimitedPartnership(
        key = "aboutYourBusinessCheckYourAnswers",
        answers = agentApplication.getBusinessDetails,
        userRole = agentApplication.getUserRole,
        canChange = false,
        entityName = entityName
      )
    case agentApplication: AgentApplicationScottishPartnership =>
      answerSummaryScottishPartnership(
        key = "aboutYourBusinessCheckYourAnswers",
        answers = agentApplication.getBusinessDetails,
        userRole = agentApplication.getUserRole,
        canChange = false,
        entityName = entityName
      )
    case _ =>
      throw new IllegalArgumentException(s"Unsupported business type for Check Your Answers page: ${agentApplication.businessType}")
  }
}
@templateScripts = {
  <script src="@{controllers.routes.Assets.versioned("javascripts/print-link.js")}" @{CSPNonce.attr}></script>
}
@templateStyles = {
  <link rel="stylesheet" href="@{controllers.routes.Assets.versioned("stylesheets/print-button.css")}" @{CSPNonce.attr}>
}
@layout(
  pageTitle = title,
  templateScripts = Some(templateScripts),
  templateStyles = Some(templateStyles)
) {
  <h1 class="govuk-heading-l">@title</h1>
  <h2 class="govuk-heading-m">@{messages(s"$key.subHeading", "HDJ2123F")}</h2>

  <h2 class="govuk-heading-m">@{messages("about-your-business.title")}</h2>
  @aboutYourBusinessAnswers

  <h2 class="govuk-heading-m">@{messages(s"$key.contact.h2")}</h2>
  @contactAnswers(
    key = "contactCheckYourAnswers",
    answers = agentApplication.getApplicantContactDetails,
    canChange = false
  )

  <h2 class="govuk-heading-m">@{messages(s"$key.agentdetails.h2")}</h2>
  @agentDetailsAnswers(
    key = "agentDetailsCheckYourAnswers",
    answers = agentApplication.getAgentDetails,
    canChange = false
  )

  <h2 class="govuk-heading-m">@{messages(s"$key.amls.h2")}</h2>
  @amlsAnswers(
    key = "amlsCheckYourAnswers",
    amlsDetails = agentApplication.getAmlsDetails,
    canChange = false
  )

  <h2 class="govuk-heading-m">@{messages(s"$key.hmrcStandard.h2")}</h2>
  @govukSummaryList(SummaryList(
    rows = Seq(
      SummaryListRow(
        key = Key(
          content = Text(messages(s"$key.hmrcStandard.label"))
        ),
        value = Value(
          content = Text(messages("common.yes"))
        )
      )
    )
  ))

  <p class="govuk-body govuk-!-display-none-print">
    @govukButton(Button(
      href = Some("#print-dialogue"),
      classes = "govuk-button--secondary gem-c-print-link__button",
      content = Text(messages("viewApplication.print"))
    ))
  </p>

}
